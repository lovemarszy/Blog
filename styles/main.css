@import 'tailwindcss';
@plugin '@tailwindcss/typography';
@config '../tailwind.config.ts';

/* ✅ 修复：在 v4 中定义自定义 max-width 变体的标准写法 */
/* 这将修复构建时出现的 Unexpected token ParenthesisBlock 警告 */
@custom-variant ss (@media (max-width: 480px));

@layer base {
  body {
    font-variation-settings: 'wght' 450;
  }
  h1 {
    font-variation-settings: 'wght' 650;
    letter-spacing: -0.02em;
    font-size: 1.6em !important;
    margin-bottom: 0.4em !important;
  }
  h2 {
    font-variation-settings: 'wght' 600;
    letter-spacing: -0.015em;
  }
  h3,
  h4,
  h5,
  h6 {
    font-variation-settings: 'wght' 600;
  }
  b,
  strong {
    font-variation-settings: 'wght' 600;
  }
  article {
    /* ✅ 变体 ss 现在会正确生成 @media (max-width: 480px) */
    @apply ss:pb-16 ss:pt-8;
  }
  p,
  li {
    @apply text-p-light dark:text-gray-300;
  }
  blockquote {
    @apply dark:!border-l-zinc-600;
  }
  summary {
    cursor: pointer;
  }
  hr {
    @apply dark:!border-[#292c2d];
  }
  a {
    text-underline-position: from-font;
    text-decoration-skip-ink: all;
    /* ✅ 严格遵守 v4 语法：! 必须修饰工具类本身，且位于变体冒号之后 */
    @apply !decoration-dec-light dark:!decoration-dec-dark !font-medium !underline !decoration-from-font !transition-opacity hover:!opacity-70;
  }
  a[data-footnote-ref] {
    text-decoration: none !important;
    padding: 0.2rem;
  }
}

@media screen and (min-device-pixel-ratio: 1.5), screen and (min-resolution: 1.5dppx) {
  body {
    @apply antialiased;
  }
}

/* Link Behavior */
.nx-mb-8 .nx-flex a {
  @apply text-gray-600 dark:text-gray-100;
}
.nx-mb-8 .nx-flex .nx-cursor-default {
  word-break: break-word;
  @apply text-inactive-nav-light dark:text-inactive-nav-dark;
}

/* Post List */
.font-variation-500 {
  font-variation-settings: 'wght' 500;
}
.date {
  font-feature-settings:
    'case' 1,
    'cpsp' 1,
    'dlig' 1,
    'cv01' 1,
    'cv02',
    'cv03' 1,
    'cv04' 1,
    'tnum' 1,
    'calt' 1;
}
.post-item {
  display: none;
}

/* Article Style */
.nx-container {
  line-height: 1.6;
  word-spacing: -0.04em;
  max-width: 40rem;
}
.dark .md\:nx-prose {
  font-variation-settings: 'wght' 400;
}

/* Code blocks */
.md\:nx-prose code::before,
.md\:nx-prose code::after {
  content: none;
}
.md\:nx-prose code {
  border: none;
  padding: 2px 4px;
  font-weight: 500;
  font-variation-settings: 'wght' 500;
}
article.prose pre code {
  display: inline-block;
  padding: 0;
  color: #545454;
  font-size: 0.9em;
}
.dark article.prose pre code {
  color: #e9e9e9;
}
article.prose pre {
  background-color: #f7f7f7 !important;
  letter-spacing: 0;
}
.dark article.prose pre {
  background-color: #1f1f1f !important;
}
.dark .dark\:prose-dark ul > li::before {
  background-color: #4b4f50;
}
.nx-border {
  border-width: 0px;
}
.nx-block {
  display: table;
}

/* 强制显示并美化文章底部的标签容器 */
.nx-mt-12 .nx-block.nx-text-gray-500 {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  margin-top: 2rem;
}
